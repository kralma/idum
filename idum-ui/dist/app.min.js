!function(e){e.module("app",["ngRoute","textAngular","pascalprecht.translate","ngCookies","ui.bootstrap","ngFileUpload"])}(angular),function(e){var t=e.module("app");t.constant("restUrlPrefix","api/")}(angular),function(e){e.module("app").config(["$routeProvider","$locationProvider",function(e,t){e.when("/login",{controller:"UserCtrl",templateUrl:"/idum-ui/app/templates/login.tmpl.html"}),e.when("/register",{controller:"UserCtrl",templateUrl:"/idum-ui/app/templates/register.tmpl.html"}),e.when("/projects",{controller:"ProjectsListCtrl",templateUrl:"/idum-ui/app/templates/projects.tmpl.html"}),e.when("/new-project",{controller:"NewProjectCtrl",templateUrl:"/idum-ui/app/templates/new-project.tmpl.html"}),e.when("/projects/:projectId",{controller:"ProjectCtrl",templateUrl:"/idum-ui/app/templates/project-detail.tmpl.html"}),t.html5Mode(!0)}])}(angular),function(e){e.module("app").controller("DialogsCtrl",["$scope","$rootScope","DialogService",function(e,t,n){t.$on("newFlashNotification",function(){e.flashNotifications=n.flashNotifications}),t.$on("newDialog",function(){e.dialogs=n.dialogs})}])}(angular),function(e){e.module("app").controller("HeaderCtrl",["$rootScope","$scope","$location","$filter",function(t,n,r,o){function a(){var t=e.element(document.getElementById("mainHeader")),n=t[0].clientHeight;document.getElementById("mainContent").style.marginTop=n+"px"}a(),window.onresize=function(){a()},n.$on("$routeChangeStart",function(e,t,n){})}])}(angular),function(e){e.module("app").controller("ProjectsListCtrl",["$scope","ProjectService","DialogService","$location",function(e,t,n,r){t.getProjects().then(function(t){e.projects=t.data})}]),e.module("app").controller("NewProjectCtrl",["$scope","ProjectService","DialogService","$location",function(e,t,n,r){e.createProject=function(){t.createProject(e.project).then(function(e){n.sendPositiveNotification("Projekt byl úspěšně vytvořen"),r.path("projects/"+e.data.projectId)})}}]),e.module("app").controller("ProjectCtrl",["$scope","ProjectService","DialogService","SensorDataService","$routeParams",function(e,t,n,r,o){var a=o.projectId;t.getProject(a).then(function(t){e.project=t.data}),e.getExtendedData=function(e){e.showExtended=!0,r.getSensorData(e.sensorId).then(function(t){e.allValues=t.data})}}])}(angular),function(e){e.module("app").controller("SensorDataCtrl",["$scope","SensorDataService",function(e,t){t.getSensorData().then(function(t){e.data=t.data})}])}(angular),function(e){e.module("app").controller("UserCtrl",["$rootScope","$scope","UserService","DialogService",function(e,t,n,r){n.currentUser().then(function(t){e.loggedUser=t.data}),t.login=function(){n.login(t.user).then(function(n){var o=n.data;o?(r.sendPositiveNotification("Přihlášení proběhlo v pořádku"),e.loggedUser=o,t.detailsBoxShown=!1):r.sendNegativeNotification("Chybné přihlašovací údaje")})},t.register=function(){n.register(t.user).then(function(e){console.log(e.data)})},t.logout=function(){n.logout().then(function(n){e.loggedUser=n.data,r.sendPositiveNotification("Odhlášení proběhlo v pořádku"),t.detailsBoxShown=!1})}}])}(angular),function(e){var t=e.module("app");t.directive("graph",["$window",function(t){return{restrict:"E",replace:!0,transclude:!1,template:"<div><svg width='200' height='200'></svg></div>",scope:{data:"="},link:function(n,r,o){function a(){if(null!=n.data){var e=r[0].clientWidth,t=4*e/16,o=r[0].firstChild;o.setAttribute("width",e),o.setAttribute("height",t);var a=n.data[0].value,i=n.data[0].value;for(var l in n.data)n.data.hasOwnProperty(l)&&(n.data[l].value<a?a=n.data[l].value:n.data[l].value>i&&(i=n.data[l].value));var s=n.data[0],c=n.data.length,u=n.data[c-1],p=s.dateInsert,d=u.dateInsert,m=d-p,g=i-a,f=e/m,v=.9*t/g,h="";for(l in n.data)if(n.data.hasOwnProperty(l)){var j=n.data[l],w=(j.dateInsert-p)*f,b=t-(j.value-a)*v;h=h+w+","+b+" "}o.innerHTML='<polyline points="'+h+'" style="fill:none;stroke:black;stroke-width:3"/>'}}n.$watch("data",function(){a()}),e.element(t).bind("resize",function(){a()})}}}])}(angular),function(e){e.module("app").directive("modalDialog",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{shown:"=",action:"=?",negativeAction:"=?",btns:"=?",outputObject:"=?"},templateUrl:"idum-ui/app/js/directives/templates/modal-dialog.tmpl.html",link:function(e,t,n){e.dialogTexts={},e.dialogTexts.title=n.title,e.dialogTexts.content=n.content,n.spinner&&(e.spinner=!0,e.preventClose=!0),!e.btns&&n.positiveLabel&&(e.positiveBtn={label:n.positiveLabel,class:n.positiveClass?n.positiveClass:"positive"},n.negativeLabel?(e.negativeBtn={label:n.negativeLabel,class:n.negativeClass?n.negativeClass:"neutral"},e.btns=[e.negativeBtn,e.positiveBtn]):e.btns=[e.positiveBtn]),e.preventClose||document.addEventListener("keydown",function(t){27===t.keyCode&&(e.shown=!1,e.$apply())}),e.close=function(){e.preventClose||(e.shown=!1)},e.$watch("action",function(){var t=e.positiveBtn;t&&(t.action=function(){e.shown=!1,e.action&&e.action()})}),e.$watch("negativeAction",function(){var t=e.negativeBtn;t&&(t.action=function(){e.shown=!1,e.negativeAction&&e.negativeAction()})})}}})}(angular),function(e){e.module("app").directive("notificationDialog",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{shown:"="},templateUrl:"idum-ui/app/js/directives/templates/notification-dialog.tmpl.html",link:function(e,t,n){e.title=n.title,e.preventClose||document.addEventListener("keydown",function(t){27===t.keyCode&&(e.shown=!1,e.$apply())}),e.close=function(){e.preventClose||(e.shown=!1)}}}})}(angular),function(e){e.module("app").directive("sensorPreview",function(){return{restrict:"E",replace:!0,scope:{sensor:"="},templateUrl:"idum-ui/app/js/directives/templates/sensor-preview.tmpl.html",link:function(e,t,n){e.showMore=!1,e.getExtendedData=function(){e.showMore=!0,SensorDataService.getSensorData(e.sensor.sensorId).then(function(t){e.allValues=t.data})}}}})}(angular),function(e){e.module("app").service("DialogService",["$rootScope",function(e){function t(t,n){return n||(n=1e4),p.forEach(function(e){e.shown=!1}),t.shown=!0,setTimeout(function(){t.shown=!1,e.$apply()},n),p.push(t),e.$broadcast("newFlashNotification"),t}function n(t){return u.forEach(function(e){e.shown=!1}),t.shown=!0,u.push(t),e.$broadcast("newDialog"),t}function r(e,n){return t({title:e,type:"positive"},n)}function o(e,n){return t({title:e,type:"negative"},n)}function a(e,n){return t({title:e,type:"neutral"},n)}function i(e,n){return t({title:e,type:"primary"},n)}function l(e){var t={title:e,spinner:!0};return n(t)}function s(e,t,r,o,a,i,l){var s={title:e,content:t,action:r,positiveLabel:o,negativeLabel:a,positiveClass:i,negativeClass:l};return n(s)}function c(e,t,r,o,a,i,l,s){var c={title:e,content:t,action:r,negativeAction:o,positiveLabel:a,negativeLabel:i,positiveClass:l,negativeClass:s};return n(c)}var u=[],p=[];return{sendPositiveNotification:r,sendNeutralNotification:a,sendNegativeNotification:o,sendInfoNotification:i,createLoadingDialog:l,createConfirmDialog:s,createDecisionDialog:c,flashNotifications:p,dialogs:u}}])}(angular),function(e){var t=e.module("app");t.service("ProjectService",["restUrlPrefix","$http",function(e,t){return{createProject:function(n){return t({method:"POST",url:e+"projects.php",data:n})},getProject:function(n){return t({method:"GET",url:e+"projects.php?project_id="+n})},getProjects:function(){return t({method:"GET",url:e+"projects.php"})}}}])}(angular),function(e){var t=e.module("app");t.service("SensorDataService",["restUrlPrefix","$http",function(e,t){return{getSensorData:function(n){return t({method:"GET",url:e+"values.php?sensorId="+n})},setSensorData:function(n){return t({method:"POST",url:e+"values.php"})}}}])}(angular),function(e){var t=e.module("app");t.service("SensorService",["restUrlPrefix","$http",function(e,t){return{createSensor:function(n){return t({method:"POST",url:e+"sensors.php",data:n})},getProjectSensors:function(n){return t({method:"GET",url:e+"sensors.php?projectId="+n})}}}])}(angular),function(e){var t=e.module("app");t.service("UserService",["restUrlPrefix","$http",function(e,t){return{register:function(n){return t({method:"POST",url:e+"register.php",data:n})},login:function(n){return t({method:"POST",url:e+"login.php",data:n})},currentUser:function(){return t({method:"GET",url:e+"login.php"})},logout:function(){return t({method:"GET",url:e+"logout.php"})}}}])}(angular),angular.module("app").run(["$templateCache",function(e){e.put("idum/login.tmpl.html",'<form class="login" data-ng-submit="login()">\n    <input type="text" required data-ng-model="user.username">\n\n    <input type="password" required data-ng-model="user.password">\n\n    <button type="submit">\n        Log in\n    </button>\n</form>\n'),e.put("idum/new-project.tmpl.html",'<h1>\r\n    Nový projekt\r\n</h1>\r\n<form data-ng-submit="createProject()">\r\n    <div class="form-group">\r\n        <label for="projectName">\r\n            Název projektu\r\n        </label>\r\n        <input type="text" id="projectName" data-ng-model="project.projectName">\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="projectDescription">\r\n            Popis projektu\r\n        </label>\r\n        <textarea id="projectDescription" rows="5" data-ng-model="project.projectDescription">\r\n        </textarea>\r\n    </div>\r\n    <div class="btns-bottom">\r\n        <button type="submit" class="btn positive large pull-right ico tick">\r\n            Vytvořit\r\n        </button>\r\n    </div>\r\n</form>\r\n'),e.put("idum/project-detail.tmpl.html",'<h1>\r\n    {{project.projectName}}\r\n</h1>\r\n<p>\r\n    {{project.projectDescription}}\r\n</p>\r\n<h2>\r\n    Senzory\r\n</h2>\r\n<ul>\r\n    <li data-ng-repeat="client in project.clients">\r\n        <h3>{{client.clientName}}</h3>\r\n        <code>{{client.clientKey}}</code>\r\n        <ul>\r\n            <li data-ng-repeat="sensor in client.sensors">\r\n                {{sensor.sensorName}} - {{sensor.lastValue.value ? sensor.lastValue.value : "Neznámá hodnota"}}\r\n                <a data-ng-click="getExtendedData(sensor)">\r\n                    Podrobnosti\r\n                </a>\r\n                <div data-ng-show="sensor.showExtended">\r\n                    <graph style="width: 100%;" data="sensor.allValues">\r\n                    </graph>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n</ul>'),e.put("idum/projects.tmpl.html",'<ul class="preview-list">\r\n    <li data-ng-repeat="project in projects">\r\n        <a data-ng-href="projects/{{project.projectId}}">\r\n            {{project.projectName}}\r\n        </a>\r\n    </li>\r\n</ul>\r\n\r\n<a data-ng-href="new-project">\r\n    Nový projekt\r\n</a>'),e.put("idum/register.tmpl.html",'<form class="register" data-ng-controller="UserCtrl" data-ng-submit="register()">\r\n    <h1>\r\n        Registrace nového uživatele\r\n    </h1>\r\n    <div class="form-group">\r\n        <label for="name">\r\n            Jméno\r\n        </label>\r\n        <input name="name" id="name" type="text" required data-ng-model="user.name">\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="username">\r\n            Uživatelské jméno\r\n        </label>\r\n        <input name="username" id="username" type="text" required data-ng-model="user.username">\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="email">\r\n            Email\r\n        </label>\r\n        <input name="email" id="email" type="email" required data-ng-model="user.email">\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="password">\r\n            Heslo\r\n        </label>\r\n        <input name="password" id="password" type="password" required data-ng-model="user.password">\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="passwordAgain">\r\n            Heslo znovu\r\n        </label>\r\n        <input name="passwordAgain" id="passwordAgain" type="password" required data-ng-model="passwordAgain">\r\n    </div>\r\n    <div class="btns-bottom">\r\n        <button type="submit" class="btn positive ico tick large pull-right">\r\n            Registrovat\r\n        </button>\r\n    </div>\r\n</form>'),e.put("idum/sensor.tmpl.html",'<div data-ng-controller="SensorDataCtrl">\r\n    <graph data="data" style="width: 100%"></graph>\r\n</div>')}]);
//# sourceMappingURL=app.min.js.map
